applications:
  - name: dms-backend-prod
    tier: x3.micro
    github:
      owner: team-aliens
      repo: DMS-Backend
      branch: main
      installationId: "64597732"
      hash: latest
    build:
      gradle:
        version: 17
        outputPath: /dms-infrastructure/build/libs/*.jar
        sourcePath: /
        buildCmd: export _JAVA_OPTIONS="-XX:-UsePerfData" && ./gradlew build -x test -x detekt --build-cache --no-daemon
    endpoints:
      - port: 8080
        routes:
          - dms-api.dms-dsm.com
  - name: dms-backend-stag
    tier: x3.micro
    github:
      owner: team-aliens
      repo: DMS-Backend
      branch: develop
      installationId: "64597732"
      hash: latest
    build:
      gradle:
        version: 17
        outputPath: /dms-infrastructure/build/libs/*.jar
        sourcePath: /
        buildCmd: export _JAVA_OPTIONS="-XX:-UsePerfData" && ./gradlew build -x test -x detekt --build-cache --no-daemon
    endpoints:
      - port: 8080
        routes:
          - dms-dev-api.dms-dsm.com
  - name: dms-frontend-prod
    tier: x3.small
    github:
      owner: team-aliens
      repo: DMS-Frontend
      branch: main
      installationId: "64597732"
      hash: latest
    build:
      react:
        version: "22"
        outputPath: /services/admin/build
        sourcePath: /
        buildCmd: yarn install && yarn workspace @service/admin build
    endpoints:
      - port: 8080
        routes:
          - admin.dms-dsm.com
  - name: dms-frontend-stag
    tier: x3.small
    github:
      owner: team-aliens
      repo: DMS-Frontend
      branch: dev
      installationId: "64597732"
      hash: latest
    build:
      react:
        version: "22"
        outputPath: /services/admin/build
        sourcePath: /
        buildCmd: yarn install && yarn workspace @service/admin build
    endpoints:
      - port: 8080
        routes:
          - admin-dev.dms-dsm.com
  - name: dms-webview-prod
    tier: x3.small
    github:
      owner: team-aliens
      repo: dms-webview
      branch: main
      installationId: "64597732"
      hash: latest
    build:
      react:
        version: "22"
        outputPath: /build
        sourcePath: /
        buildCmd: yarn install && yarn build
    endpoints:
      - port: 8080
        routes:
          - webview.dms-dsm.com
