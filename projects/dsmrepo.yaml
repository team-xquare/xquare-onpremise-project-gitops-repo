applications:
  - name: whopper-prod
    github:
      owner: DSM-Repo
      repo: Whopper
      branch: main
      installationId: "79908920"
      hash: 78aca872250585bb0874ae87de9f5ae250f7e585
    build:
      gradle:
        javaVersion: 21
        jarOutputPath: /build/libs/*.jar
        buildCommand: ./gradlew bootJar -x test
    endpoints:
      - port: 8080
        routes:
          - api.dsm-repo.com
  - name: repo-main-prod
    github:
      owner: DSM-Repo
      repo: repo
      branch: main
      installationId: "79908920"
      hash: bd4d50dd491eff1ed5d2def1342871e81887db94
    build:
      vite:
        nodeVersion: "18"
        distPath: /packages/main/dist
        buildCommand: yarn install --frozen-lockfile && NODE_ENV=production yarn workspace main build
    endpoints:
      - port: 8080
        routes:
          - www.dsm-repo.com
  - name: repo-teacher-prod
    github:
      owner: DSM-Repo
      repo: repo
      branch: main
      installationId: "79908920"
      hash: f0415a3b0c2f72d4cb10bfaf87c9a3582f7c56c5
    build:
      vite:
        nodeVersion: "18"
        distPath: /packages/teacher/dist
        buildCommand: yarn install --frozen-lockfile && NODE_ENV=production yarn workspace teacher build
    endpoints:
      - port: 8080
        routes:
          - teacher.dsm-repo.com
  - name: repo-user-prod
    github:
      owner: DSM-Repo
      repo: repo
      branch: main
      installationId: "79908920"
      hash: bd4d50dd491eff1ed5d2def1342871e81887db94
    build:
      vite:
        nodeVersion: "18"
        distPath: /packages/student/dist
        buildCommand: yarn install --frozen-lockfile && NODE_ENV=production yarn workspace student build
    endpoints:
      - port: 8080
        routes:
          - user.dsm-repo.com
addons:
  - name: dsmrepo-redis
    type: redis
    storage: 1Gi
  - name: dsmrepo-mongodb
    type: mongodb
    storage: 1Gi
